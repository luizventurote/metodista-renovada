<!DOCTYPE html>
<html lang="pt-br">

<head>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-209076308-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-209076308-2');
    </script>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" type="image/png" href="/assets/favicon.jpg" />

    <link href="/assets/styles-output.css" rel="stylesheet">

    <title>Intercess√£o pelo minist√©rio pastoral - Igreja Metodista Renovada</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/background-timer/1.0.0/background-timer.min.js"></script>

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://metodista.org/orar-batatais">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Link de Ora√ß√£o - Igreja Metodista Renovada Uberaba">
    <meta property="og:description" content="Convidamos voc√™ a dedicar um momento do seu dia para interceder pelas demandas da nossa igreja.">
    <meta property="og:image" content="https://metodista.org/assets/link-igreja-oracao.jpg">
    <meta property="og:locale" content="pt_BR"/>

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="metodista.org">
    <meta property="twitter:url" content="https://metodista.org/orar-batatais">
    <meta name="twitter:title" content="Link de Ora√ß√£o - Igreja Metodista Renovada Uberaba">
    <meta name="twitter:description" content="Convidamos voc√™ a dedicar um momento do seu dia para interceder pelas demandas da nossa igreja.">
    <meta name="twitter:image" content="https://metodista.org/assets/link-igreja-oracao.jpg">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
    </style>

</head>

<body class="bg-black font-inter px-5">

    <div class="max-w-[700px] m-auto pt-3 text-white text-center">

        <h1 class="text-3xl mt-10 mb-7 font-bold">Fa√ßa a sua ora√ß√£o</h1>

        <div data-timer-screen class="flex flex-col my-10 gap-5 justify-center max-w-[300px] m-auto">

            <button data-timer-init
                class="bg-[#00ffc2] m-auto text-black font-bold w-[220px] h-[220px] p-10 rounded-full">Iniciar
                Ora√ß√£o</button>

            <p data-welcome-message></p>

            <div data-timer class="hidden py-10 text-5xl">00:00:00</div>

            <button data-timer-pause
                class="hidden flex border border-white solid rounded-md py-3 text-center justify-center px-8 text-white font-bold transition-all hover:scale-105">Pausar
                Ora√ß√£o</button>

            <button data-timer-send
                class="hidden flex bg-[#00ffc2] text-black solid rounded-md py-3 text-center justify-center px-8 font-bold transition-all hover:scale-105">Enviar
                Ora√ß√£o</button>

            <button data-timer-play
                class="hidden flex border border-white solid rounded-md py-3 text-center justify-center px-8 text-white font-bold transition-all hover:scale-105">Continuar
                orando</button>

            <button data-timer-delete
                class="hidden flex border border-red-500 solid rounded-md py-3 text-center justify-center px-8 text-red-500 font-bold transition-all hover:scale-105">Cancelar
                ora√ß√£o</button>

        </div>

        <div datat-thankyou-screen class="hidden flex flex-col my-10 gap-5 justify-center max-w-[300px] m-auto">

            <h2 class="text-2xl mt-10 mb-7 font-bold">Obrigado por orar</h2>

            <p>Que Deus aben√ßoe a sua vida e a nossa igreja üôè</p>

            <button data-timer-reset
                class="flex border border-white solid rounded-md py-3 text-center justify-center px-8 text-white font-bold transition-all hover:scale-105">Continuar
                orando</button>

        </div>

        <footer class=" py-9 px-8">
            <img class="m-auto" src="assets/Logo Igreja Wide.svg" alt="Igreja Metodista Renovada">
        </footer>

    </div>

    <script>

        const timer = document.querySelector('[data-timer]');
        const timerInit = document.querySelector('[data-timer-init]');
        const timerPause = document.querySelector('[data-timer-pause]');
        const timerSend = document.querySelector('[data-timer-send]');
        const timerPlay = document.querySelector('[data-timer-play]');
        const timerReset = document.querySelector('[data-timer-reset]');
        const timerDelete = document.querySelector('[data-timer-delete]');
        const timerScreen = document.querySelector('[data-timer-screen]');
        const thankyouScreen = document.querySelector('[datat-thankyou-screen]');

        let time = 0;
        let interval;

        let startTime;
        let elapsedTime = 0;  // Store the elapsed time if the user pauses
        
        let userName = localStorage.getItem('userName') || '';
        let userPhone = localStorage.getItem('userPhone') || '';
        let userEmail = localStorage.getItem('userEmail') || '';

        // Timer with hours, minutes and seconds. Displayed in a div like this: 00:00:00
        function startTimer() {

            startTime = Date.now() - elapsedTime;  // Adjust for elapsed time if the timer was paused

            interval = setInterval(() => {

                const currentTime = Date.now();
                time = Math.floor((currentTime - startTime) / 1000);  // Calculate elapsed seconds

                const hours = Math.floor(time / 3600);
                const minutes = Math.floor((time % 3600) / 60);
                const seconds = time % 60;
                timer.textContent = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            
            }, 1000);
        }

        function hideStartButton() {
            timerInit.classList.add('hidden');

            // Hide the welcome message
            document.querySelector('[data-welcome-message]').classList.add('hidden');
        }

        function showStartButton() {
            timerInit.classList.remove('hidden');
        }

        function showTimer() {
            timer.classList.remove('hidden');
        }

        function hideTimer() {
            timer.classList.add('hidden');
        }

        function showPauseButton() {
            timerPause.classList.remove('hidden');
        }

        function hidePauseButton() {
            timerPause.classList.add('hidden');
        }

        function showSendButton() {
            timerSend.classList.remove('hidden');
        }

        function hideSendButton() {
            timerSend.classList.add('hidden');
        }

        function showPlayButton() {
            timerPlay.classList.remove('hidden');
        }

        function hidePlayButton() {
            timerPlay.classList.add('hidden');
        }

        function showDeleteButton() {
            timerDelete.classList.remove('hidden');
        }

        function hideDeleteButton() {
            timerDelete.classList.add('hidden');
        }

        function showThankYouScreen() {
            timerScreen.classList.add('hidden');
            thankyouScreen.classList.remove('hidden');
        }

        function hideThankYouScreen() {
            thankyouScreen.classList.add('hidden');
            timerScreen.classList.remove('hidden');
        }

        function resetTimer() {
            clearInterval(interval);
            time = 0;
            timer.textContent = '00:00:00';
            hidePlayButton();
            hideSendButton();
            hideDeleteButton();
        }

        function sendPrayer() {

            console.log('Prayer sent', time);

            // Inform user name
            if (!userName || userName === '') {
                userName = prompt('Qual √© o seu nome?');
                localStorage.setItem('userName', userName);
            }

            // Inform user phone
            if (!userPhone || userPhone === '') {
                userPhone = prompt('Qual √© o seu telefone?');
                localStorage.setItem('userPhone', userPhone);
            }

            // Send prayer to the server
            fetch('https://n8n.venturote.com/webhook/enviar-oracao', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    time: time,
                    date: new Date().toISOString(),
                    name: userName,
                    phone: userPhone,
                    id: 'imr-uberaba'
                }),
            }).then(response => response.json()).then(data => {
                console.log('Success:', data);
            }).catch((error) => {
                console.error('Error:', error);
            });
        }

        timerInit.addEventListener('click', () => {
            hideStartButton();
            showTimer();
            showPauseButton();
            startTimer();
            timerInit.disabled = true;
        });

        timerPause.addEventListener('click', () => {
            clearInterval(interval);
            hidePauseButton();
            showSendButton();
            showPlayButton();
            showDeleteButton();
        });

        timerPlay.addEventListener('click', () => {
            startTimer();
            hidePlayButton();
            hideSendButton();
            showPauseButton();
            hideDeleteButton();
        });

        timerSend.addEventListener('click', () => {
            sendPrayer();
            showThankYouScreen();
            resetTimer();
        });

        timerReset.addEventListener('click', () => {
            hideThankYouScreen();
            resetTimer();
            showTimer();
            showPauseButton();
            startTimer();
        });

        timerDelete.addEventListener('click', () => {

            // Show a confirmation dialog
            if (confirm('Tem certeza que deseja cancelar a ora√ß√£o?')) {
                hideThankYouScreen();
                resetTimer();
                showPlayButton();
            }
        });

    </script>

</body>

</html>